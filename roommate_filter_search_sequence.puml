@startuml
title "Reference: Filter and Search Functionality"

!define STUDENT_COLOR #E3F2FD
!define BACKEND_COLOR #E8F5E9
!define ALGO_COLOR #FFF3E0

actor "Student" as Student
participant "Angular Frontend" as Frontend

box "Backend Services"
    participant "RecommendationController" as Controller
    participant "RecommendationService" as Service
    participant "CompatibilityService" as Compatibility
    participant "UserRoommatePreferencesService" as Preferences
    participant "Database" as DB
end box

== Filter & Search Functionality ==

Student -> Frontend: 52. Apply filters (budget, location, lifestyle)
activate Frontend

Frontend -> Controller: 53. GET /api/v1/recommendations/roommates?filters=budget:500-800,location:campus,lifestyle:QUIET
activate Controller

Controller -> Service: 54. getRecommendationsForUser(userId, limit, filters)
activate Service

Service -> Service: 55. Apply filters to recommendations

Service -> Compatibility: 56. Re-calculate compatibility with filters
activate Compatibility
Compatibility --> Service: 57. Filtered AnnouncementWithScore[]
deactivate Compatibility

Service --> Controller: 58. Filtered recommendations
deactivate Service

Controller --> Frontend: 59. 200 OK - Filtered results
deactivate Controller

Frontend --> Student: 60. Display filtered recommendations
deactivate Frontend

@enduml 