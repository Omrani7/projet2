@startuml
title "Reference: Tab Switching and Caching"

!define STUDENT_COLOR #E3F2FD
!define BACKEND_COLOR #E8F5E9
!define ALGO_COLOR #FFF3E0

actor "Student" as Student
participant "Angular Frontend" as Frontend

box "Backend Services"
    participant "RecommendationController" as Controller
    participant "RecommendationService" as Service
    participant "CompatibilityService" as Compatibility
    participant "UserRoommatePreferencesService" as Preferences
    participant "Database" as DB
end box

== Tab Switching & Caching ==

loop User Switches Between Tabs
    Student -> Frontend: 45. Switch to different tab
    activate Frontend
    
    alt Data already cached
        Frontend -> Frontend: 46a. Load from cache
        Frontend --> Student: 47a. Instant display (cached data)
    else Data not cached or expired
        Frontend -> Controller: 46b. GET appropriate endpoint
        activate Controller
        Controller -> Service: 47b. Execute corresponding service method
        activate Service
        Service --> Controller: 48b. Fresh data
        deactivate Service
        Controller --> Frontend: 49b. 200 OK - Fresh recommendations
        deactivate Controller
        Frontend -> Frontend: 50b. Cache data for future use
        Frontend --> Student: 51b. Display fresh data
    end
    
    deactivate Frontend
end

@enduml 